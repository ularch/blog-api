# ğŸ“ åšå®¢ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿè®¿é—®

ä½ çš„åšå®¢ API æ­£åœ¨è¿è¡Œï¼š**http://localhost:8787**

## ğŸ“š åŸºæœ¬æ“ä½œ

### 1. æŸ¥çœ‹æ‰€æœ‰æ–‡ç« 

```bash
# åŸºæœ¬æŸ¥è¯¢
curl "http://localhost:8787/api/posts"

# æ ¼å¼åŒ–æ˜¾ç¤º
curl -s "http://localhost:8787/api/posts" | jq .

# åªæ˜¾ç¤ºæ ‡é¢˜å’Œä½œè€…
curl -s "http://localhost:8787/api/posts" | jq '.posts[] | {id, title, author}'
```

### 2. æŸ¥çœ‹å•ç¯‡æ–‡ç« 

```bash
# æŸ¥çœ‹ ID ä¸º 1 çš„æ–‡ç« 
curl "http://localhost:8787/api/posts/1"

# æ ¼å¼åŒ–æ˜¾ç¤º
curl -s "http://localhost:8787/api/posts/1" | jq .
```

### 3. åˆ›å»ºæ–°æ–‡ç« 

```bash
curl -X POST "http://localhost:8787/api/posts" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "æ–‡ç« æ ‡é¢˜",
    "content": "æ–‡ç« å†…å®¹",
    "author": "ä½œè€…å",
    "slug": "article-slug",
    "status": "published",
    "excerpt": "æ–‡ç« æ‘˜è¦"
  }'
```

**å¿…éœ€å­—æ®µ**ï¼š
- `title`: æ–‡ç« æ ‡é¢˜
- `content`: æ–‡ç« å†…å®¹
- `author`: ä½œè€…
- `slug`: URL å‹å¥½çš„æ ‡è¯†ç¬¦

**å¯é€‰å­—æ®µ**ï¼š
- `status`: published/draft/archived (é»˜è®¤: draft)
- `excerpt`: æ–‡ç« æ‘˜è¦
- `tags`: æ ‡ç­¾ (JSON æ ¼å¼)

### 4. æ›´æ–°æ–‡ç« 

```bash
curl -X PUT "http://localhost:8787/api/posts/1" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "æ›´æ–°åçš„æ ‡é¢˜",
    "content": "æ›´æ–°åçš„å†…å®¹"
  }'
```

### 5. åˆ é™¤æ–‡ç« 

```bash
curl -X DELETE "http://localhost:8787/api/posts/1"
```

## ğŸ” é«˜çº§æŸ¥è¯¢

### åˆ†é¡µæŸ¥è¯¢

```bash
# ç¬¬ä¸€é¡µï¼Œæ¯é¡µ 5 ç¯‡æ–‡ç« 
curl "http://localhost:8787/api/posts?page=1&limit=5"

# ç¬¬äºŒé¡µ
curl "http://localhost:8787/api/posts?page=2&limit=5"
```

### æŒ‰çŠ¶æ€ç­›é€‰

```bash
# åªæ˜¾ç¤ºå·²å‘å¸ƒçš„æ–‡ç« 
curl "http://localhost:8787/api/posts?status=published"

# åªæ˜¾ç¤ºè‰ç¨¿
curl "http://localhost:8787/api/posts?status=draft"

# åªæ˜¾ç¤ºå·²å½’æ¡£çš„æ–‡ç« 
curl "http://localhost:8787/api/posts?status=archived"
```

### ç»„åˆæŸ¥è¯¢

```bash
# å·²å‘å¸ƒæ–‡ç« çš„ç¬¬ä¸€é¡µï¼Œæ¯é¡µ 3 ç¯‡
curl "http://localhost:8787/api/posts?status=published&page=1&limit=3"
```

## ğŸŒ åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹

ç”±äºè¿™æ˜¯ä¸€ä¸ª API æœåŠ¡ï¼Œä½ å¯ä»¥ï¼š

### 1. ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®
- æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8787/api/posts
- æµè§ˆå™¨ä¼šæ˜¾ç¤º JSON æ ¼å¼çš„æ–‡ç« åˆ—è¡¨

### 2. ä½¿ç”¨æµè§ˆå™¨æ‰©å±•
æ¨èå®‰è£… JSON æ ¼å¼åŒ–æ‰©å±•ï¼Œå¦‚ï¼š
- JSON Formatter (Chrome)
- JSONView (Firefox)

### 3. åˆ›å»ºç®€å•çš„å‰ç«¯é¡µé¢

ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ HTML é¡µé¢æ¥æ˜¾ç¤ºåšå®¢ï¼š

```html
<!DOCTYPE html>
<html>
<head>
    <title>æˆ‘çš„åšå®¢</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .post { border-bottom: 1px solid #eee; padding: 20px 0; }
        .title { color: #333; }
        .meta { color: #666; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>æˆ‘çš„åšå®¢</h1>
    <div id="posts"></div>
    
    <script>
        fetch('http://localhost:8787/api/posts')
            .then(response => response.json())
            .then(data => {
                const postsDiv = document.getElementById('posts');
                data.posts.forEach(post => {
                    postsDiv.innerHTML += `
                        <div class="post">
                            <h2 class="title">${post.title}</h2>
                            <div class="meta">ä½œè€…ï¼š${post.author} | å‘å¸ƒæ—¶é—´ï¼š${post.published_at}</div>
                            <p>${post.excerpt}</p>
                        </div>
                    `;
                });
            });
    </script>
</body>
</html>
```

## ğŸ“Š å½“å‰åšå®¢çŠ¶æ€

ç›®å‰ä½ çš„åšå®¢æœ‰ï¼š
- âœ… **3ç¯‡æ–‡ç« **ï¼ˆåŒ…æ‹¬ä½ åˆšåˆ›å»ºçš„é‚£ç¯‡ï¼‰
- âœ… **æœ¬åœ°å¼€å‘ç¯å¢ƒè¿è¡Œä¸­**
- âœ… **å®Œæ•´çš„ CRUD åŠŸèƒ½**

### å½“å‰æ–‡ç« åˆ—è¡¨ï¼š
1. "æ¬¢è¿æ¥åˆ°ç®€åŒ–åšå®¢" - ç®¡ç†å‘˜
2. "å…³äº Cloudflare D1" - æŠ€æœ¯ç¼–è¾‘  
3. "æˆ‘çš„ç¬¬ä¸€ç¯‡ä¸ªäººæ–‡ç« " - åšå®¢ä¸»äºº

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æ•°æ®åº“å†…å®¹

```bash
# æŸ¥çœ‹æ‰€æœ‰æ–‡ç« ï¼ˆæ•°æ®åº“å±‚é¢ï¼‰
wrangler d1 execute simple-blog-db --command="SELECT id, title, author, status FROM posts;" --local

# æŸ¥çœ‹åˆ†ç±»
wrangler d1 execute simple-blog-db --command="SELECT * FROM categories;" --local

# æŸ¥çœ‹è¯„è®º
wrangler d1 execute simple-blog-db --command="SELECT * FROM comments;" --local
```

### æœåŠ¡å™¨ç®¡ç†

```bash
# æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹
ps aux | grep wrangler

# é‡å¯æœåŠ¡å™¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
pkill -f wrangler
wrangler dev simple_blog_worker.js --local --persist-to .wrangler/state

# æŸ¥çœ‹æ—¥å¿—
tail -f wrangler.log
```

## ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

å½“ä½ å‡†å¤‡å¥½æ—¶ï¼Œå¯ä»¥éƒ¨ç½²åˆ° Cloudflareï¼š

```bash
# 1. åˆå§‹åŒ–ç”Ÿäº§æ•°æ®åº“
npm run db:init:remote

# 2. éƒ¨ç½²åˆ°ç”Ÿäº§
npm run deploy

# 3. è·å–ç”Ÿäº§ URLï¼ˆåœ¨éƒ¨ç½²è¾“å‡ºä¸­æ˜¾ç¤ºï¼‰
# ç„¶åä½ å°±å¯ä»¥ç”¨åŒæ ·çš„ API è°ƒç”¨ï¼Œåªæ˜¯æŠŠ localhost:8787 æ›¿æ¢ä¸ºç”Ÿäº§ URL
```

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. å¿«é€Ÿåˆ›å»ºå¤šç¯‡æ–‡ç« 

```bash
# åˆ›å»ºè„šæœ¬æ¥æ‰¹é‡æ·»åŠ æ–‡ç« 
for i in {1..5}; do
  curl -X POST "http://localhost:8787/api/posts" \
    -H "Content-Type: application/json" \
    -d "{
      \"title\": \"æµ‹è¯•æ–‡ç«  $i\",
      \"content\": \"è¿™æ˜¯ç¬¬ $i ç¯‡æµ‹è¯•æ–‡ç« çš„å†…å®¹ã€‚\",
      \"author\": \"æµ‹è¯•ä½œè€…\",
      \"slug\": \"test-post-$i\",
      \"status\": \"published\",
      \"excerpt\": \"æµ‹è¯•æ–‡ç«  $i çš„æ‘˜è¦\"
    }"
done
```

### 2. å¤‡ä»½æ–‡ç« 

```bash
# å¯¼å‡ºæ‰€æœ‰æ–‡ç« åˆ° JSON æ–‡ä»¶
curl -s "http://localhost:8787/api/posts?limit=1000" > blog-backup.json
```

### 3. æœç´¢æ–‡ç« ï¼ˆé€šè¿‡ slugï¼‰

```bash
# é€šè¿‡ slug æŸ¥æ‰¾æ–‡ç« ï¼ˆéœ€è¦çŸ¥é“ç¡®åˆ‡çš„ IDï¼‰
curl "http://localhost:8787/api/posts/1"  # å¦‚æœ slug æ˜¯ welcome-to-simple-blog
```

## ğŸ¯ ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å¯ä»¥ï¼š

1. **å¼€å§‹å†™åšå®¢**ï¼šç”¨ API åˆ›å»ºä½ çš„æ–‡ç« 
2. **æ„å»ºå‰ç«¯**ï¼šåˆ›å»ºä¸€ä¸ªæ¼‚äº®çš„ç½‘é¡µç•Œé¢
3. **éƒ¨ç½²ä¸Šçº¿**ï¼šæŠŠåšå®¢éƒ¨ç½²åˆ° Cloudflare
4. **æ·»åŠ åŠŸèƒ½**ï¼šè¯„è®ºç³»ç»Ÿã€æ ‡ç­¾ç®¡ç†ç­‰

äº«å—ä½ çš„æ–°åšå®¢ç³»ç»Ÿå§ï¼ğŸ‰
